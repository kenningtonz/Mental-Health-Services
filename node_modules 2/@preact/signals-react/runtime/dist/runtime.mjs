import{Signal as t,signal as e,computed as n,effect as r}from"@preact/signals-core";import i,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as o,useRef as u,useMemo as f,useEffect as s}from"react";import{useSyncExternalStore as l}from"use-sync-external-store/shim/index.js";import c from"react/jsx-runtime";import a from"react/jsx-dev-runtime";let m=!1,p=null,d=!1,b=null;const v=new Map;function g(t){if(!t)return 1;const e=v.get(t);if(void 0!==e)return e;let n;const r=t.useCallback.toString();if(t.useReducer===t.useEffect)n=1;else if(t.useEffect===t.useImperativeHandle)n=32;else if(/Invalid/.test(r))n=2;else if(/updateCallback/.test(r)||/\[0\]/.test(r)&&/\[1\]/.test(r)){let e=t.useReducer.toString();if(/rerenderReducer/.test(e)||/return\s*\[\w+,/.test(e))n=16;else n=8}else n=4;v.set(t,n);return n}function h(){!function(){m=!0;Object.defineProperty(o.ReactCurrentDispatcher,"current",{get:()=>b,set(t){if(d){b=t;return}const e=g(b),n=g(t);b=t;if(function(t,e){if(1&t&&28&e)return!0;else if(2&t||2&e)return!1;else return!1}(e,n)){d=!0;p=I(1);d=!1}else if(function(t,e){return Boolean(28&t&&16&e)}(e,n)){var r;null==(r=p)||r.f();d=!0;p=I(1);d=!1}else if(function(t,e){return Boolean(28&t&&1&e)}(e,n)){var i;null==(i=p)||i.f();p=null}}})}();!function(){const t=c,e=a;i.createElement=j(i.createElement);e.jsx&&(e.jsx=j(e.jsx));t.jsx&&(t.jsx=j(t.jsx));e.jsxs&&(e.jsxs=j(e.jsxs));t.jsxs&&(t.jsxs=j(t.jsxs));e.jsxDEV&&(e.jsxDEV=j(e.jsxDEV));t.jsxDEV&&(t.jsxDEV=j(t.jsxDEV))}()}const y=[],_=Symbol.for("react.element"),S=()=>{};function j(e){if("function"!=typeof e)return e;else return function(n,r,...i){if("string"==typeof n&&r)for(let e in r){let n=r[e];if("children"!==e&&n instanceof t)r[e]=n.value}return e.call(e,n,r,...i)}}const x=Symbol.dispose||Symbol.for("Symbol.dispose");let k;function w(t,e){const n=e.effect.S();k=e;return B.bind(e,t,n)}function B(t,e){e();k=t}const O={o:0,effect:{s:void 0,c(){},S:()=>S,d(){}},subscribe:()=>S,getSnapshot:()=>0,S(){},f(){},[x](){}},P=Promise.prototype.then.bind(Promise.resolve());let $;function C(){if(!$)$=P(()=>{var t;$=void 0;null==(t=k)||t.f()})}function I(t=0){C();const e=u();if(null==e.current)e.current=function(t){let e,n,i,o=0,u=r(function(){e=this});e.c=function(){o=o+1|0;if(i)i()};return{o:t,effect:e,subscribe(t){i=t;return function(){o=o+1|0;i=void 0;u()}},getSnapshot:()=>o,S(){if(null==k){n=w(void 0,this);return}const t=k.o,e=this.o;if(0==t&&0==e||0==t&&1==e){k.f();n=w(void 0,this)}else if(1==t&&0==e||2==t&&0==e);else n=w(k,this)},f(){null==n||n();n=void 0},[x](){this.f()}}}(t);const n=e.current;l(n.subscribe,n.getSnapshot,n.getSnapshot);n.S();return n}Object.defineProperties(t.prototype,{$$typeof:{configurable:!0,value:_},type:{configurable:!0,value:function({data:t}){const e=I(1);try{return t.value}finally{e.f()}}},props:{configurable:!0,get(){return{data:this}}},ref:{configurable:!0,value:null}});function M(t){if(m)return O;else return I(t)}function useSignal(t){return f(()=>e(t),y)}function useComputed(t){const e=u(t);e.current=t;return f(()=>n(()=>e.current()),y)}function useSignalEffect(t){const e=u(t);e.current=t;s(()=>r(()=>e.current()),y)}export{I as _useSignalsImplementation,C as ensureFinalCleanup,h as installAutoSignalTracking,useComputed,useSignal,useSignalEffect,M as useSignals,j as wrapJsx};//# sourceMappingURL=runtime.mjs.map
