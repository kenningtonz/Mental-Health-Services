{"version":3,"file":"signals.min.js","sources":["../runtime/dist/runtime.module.js","../src/index.ts"],"sourcesContent":["import{Signal as n,signal as r,computed as t,effect as e}from\"@preact/signals-core\";import i,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as u,useRef as f,useMemo as o,useEffect as c}from\"react\";import{useSyncExternalStore as l}from\"use-sync-external-store/shim/index.js\";import a from\"react/jsx-runtime\";import s from\"react/jsx-dev-runtime\";var v=!1,m=null,p=!1,d=null,b=new Map;function g(n){if(!n)return 1;var r,t=b.get(n);if(void 0!==t)return t;var e=n.useCallback.toString();if(n.useReducer===n.useEffect)r=1;else if(n.useEffect===n.useImperativeHandle)r=32;else if(/Invalid/.test(e))r=2;else if(/updateCallback/.test(e)||/\\[0\\]/.test(e)&&/\\[1\\]/.test(e)){var i=n.useReducer.toString();if(/rerenderReducer/.test(i)||/return\\s*\\[\\w+,/.test(i))r=16;else r=8}else r=4;b.set(n,r);return r}function h(){!function(){v=!0;Object.defineProperty(u.ReactCurrentDispatcher,\"current\",{get:function(){return d},set:function(n){if(!p){var r=g(d),t=g(n);d=n;if(function(n,r){if(1&n&&28&r)return!0;else if(2&n||2&r)return!1;else return!1}(r,t)){p=!0;m=M(1);p=!1}else if(function(n,r){return Boolean(28&n&&16&r)}(r,t)){var e;null==(e=m)||e.f();p=!0;m=M(1);p=!1}else if(function(n,r){return Boolean(28&n&&1&r)}(r,t)){var i;null==(i=m)||i.f();m=null}}else d=n}})}();!function(){var n=a,r=s;i.createElement=j(i.createElement);r.jsx&&(r.jsx=j(r.jsx));n.jsx&&(n.jsx=j(n.jsx));r.jsxs&&(r.jsxs=j(r.jsxs));n.jsxs&&(n.jsxs=j(n.jsxs));r.jsxDEV&&(r.jsxDEV=j(r.jsxDEV));n.jsxDEV&&(n.jsxDEV=j(n.jsxDEV))}()}var y=[],_=Symbol.for(\"react.element\"),S=function(){};function j(r){if(\"function\"!=typeof r)return r;else return function(t,e){if(\"string\"==typeof t&&e)for(var i in e){var u=e[i];if(\"children\"!==i&&u instanceof n)e[i]=u.value}return r.call.apply(r,[r,t,e].concat([].slice.call(arguments,2)))}}var x,k=Symbol.dispose||Symbol.for(\"Symbol.dispose\");function w(n,r){var t=r.effect.S();x=r;return B.bind(r,n,t)}function B(n,r){r();x=n}var O,P,$=((O={u:0,effect:{s:void 0,c:function(){},S:function(){return S},d:function(){}},subscribe:function(){return S},getSnapshot:function(){return 0},S:function(){},f:function(){}})[k]=function(){},O),C=Promise.prototype.then.bind(Promise.resolve());function I(){if(!P)P=C(function(){var n;P=void 0;null==(n=x)||n.f()})}function M(n){if(void 0===n)n=0;I();var r=f();if(null==r.current)r.current=function(n){var r,t,i,u,f=0,o=e(function(){t=this});t.c=function(){f=f+1|0;if(u)u()};return(r={u:n,effect:t,subscribe:function(n){u=n;return function(){f=f+1|0;u=void 0;o()}},getSnapshot:function(){return f},S:function(){if(null!=x){var n=x.u,r=this.u;if(0==n&&0==r||0==n&&1==r){x.f();i=w(void 0,this)}else if(1==n&&0==r||2==n&&0==r);else i=w(x,this)}else i=w(void 0,this)},f:function(){null==i||i();i=void 0}})[k]=function(){this.f()},r}(n);var t=r.current;l(t.subscribe,t.getSnapshot,t.getSnapshot);t.S();return t}Object.defineProperties(n.prototype,{$$typeof:{configurable:!0,value:_},type:{configurable:!0,value:function(n){var r=n.data,t=M(1);try{return r.value}finally{t.f()}}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});function R(n){if(v)return $;else return M(n)}function useSignal(n){return o(function(){return r(n)},y)}function useComputed(n){var r=f(n);r.current=n;return o(function(){return t(function(){return r.current()})},y)}function useSignalEffect(n){var r=f(n);r.current=n;c(function(){return e(function(){return r.current()})},y)}export{M as _useSignalsImplementation,I as ensureFinalCleanup,h as installAutoSignalTracking,useComputed,useSignal,useSignalEffect,R as useSignals,j as wrapJsx};//# sourceMappingURL=runtime.module.js.map\n","import {\n\tsignal,\n\tcomputed,\n\tbatch,\n\teffect,\n\tSignal,\n\ttype ReadonlySignal,\n\tuntracked,\n} from \"@preact/signals-core\";\nimport type { ReactElement } from \"react\";\nimport {\n\tuseSignal,\n\tuseComputed,\n\tuseSignalEffect,\n\tinstallAutoSignalTracking,\n} from \"@preact/signals-react/runtime\"; // TODO: This duplicates runtime code between main and sub runtime packages\n\nexport {\n\tsignal,\n\tcomputed,\n\tbatch,\n\teffect,\n\tSignal,\n\ttype ReadonlySignal,\n\tuseSignal,\n\tuseComputed,\n\tuseSignalEffect,\n\tuntracked,\n};\n\ndeclare module \"@preact/signals-core\" {\n\t// @ts-ignore internal Signal is viewed as function\n\t// eslint-disable-next-line @typescript-eslint/no-empty-interface\n\tinterface Signal extends ReactElement {}\n}\n\ninstallAutoSignalTracking();\n"],"names":["g","f","exports","module","require","define","amd","globalThis","self","reactSignals","preactSignalsCore","react","index_js","a","s","this","signalsCore","i","_interopDefaultLegacy","e","default","i__default","a__default","s__default","m","p","d","b","Map","n","r","t","get","useCallback","toString","useReducer","useEffect","useImperativeHandle","test","set","Object","defineProperty","u","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentDispatcher","M","Boolean","createElement","j","jsx","jsxs","jsxDEV","installAutoSignalTracking","Signal","batch","computed","effect","signal","untracked","useComputed","useSignal","useSignalEffect"],"mappings":"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"}