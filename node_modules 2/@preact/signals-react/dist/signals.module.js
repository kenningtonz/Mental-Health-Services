import{Signal as n,effect as r,signal as t,computed as e}from"@preact/signals-core";export{Signal,batch,computed,effect,signal,untracked}from"@preact/signals-core";import i,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as u,useRef as f,useMemo as o,useEffect as c}from"react";import{useSyncExternalStore as l}from"use-sync-external-store/shim/index.js";import a from"react/jsx-runtime";import s from"react/jsx-dev-runtime";var v=null,m=!1,p=null,d=new Map;function b(n){if(!n)return 1;var r,t=d.get(n);if(void 0!==t)return t;var e=n.useCallback.toString();if(n.useReducer===n.useEffect)r=1;else if(n.useEffect===n.useImperativeHandle)r=32;else if(/Invalid/.test(e))r=2;else if(/updateCallback/.test(e)||/\[0\]/.test(e)&&/\[1\]/.test(e)){var i=n.useReducer.toString();if(/rerenderReducer/.test(i)||/return\s*\[\w+,/.test(i))r=16;else r=8}else r=4;d.set(n,r);return r}var g=[],h=Symbol.for("react.element"),y=function(){};function S(r){if("function"!=typeof r)return r;else return function(t,e){if("string"==typeof t&&e)for(var i in e){var u=e[i];if("children"!==i&&u instanceof n)e[i]=u.value}return r.call.apply(r,[r,t,e].concat([].slice.call(arguments,2)))}}var x,j,k=Symbol.dispose||Symbol.for("Symbol.dispose");function w(n,r){var t=r.effect.S();x=r;return B.bind(r,n,t)}function B(n,r){r();x=n}({u:0,effect:{s:void 0,c:function(){},S:function(){return y},d:function(){}},subscribe:function(){return y},getSnapshot:function(){return 0},S:function(){},f:function(){}})[k]=function(){};var O=Promise.prototype.then.bind(Promise.resolve());function P(n){if(void 0===n)n=0;!function(){if(!j)j=O(function(){var n;j=void 0;null==(n=x)||n.f()})}();var t=f();if(null==t.current)t.current=function(n){var t,e,i,u,f=0,o=r(function(){e=this});e.c=function(){f=f+1|0;if(u)u()};return(t={u:n,effect:e,subscribe:function(n){u=n;return function(){f=f+1|0;u=void 0;o()}},getSnapshot:function(){return f},S:function(){if(null!=x){var n=x.u,r=this.u;if(0==n&&0==r||0==n&&1==r){x.f();i=w(void 0,this)}else if(1==n&&0==r||2==n&&0==r);else i=w(x,this)}else i=w(void 0,this)},f:function(){null==i||i();i=void 0}})[k]=function(){this.f()},t}(n);var e=t.current;l(e.subscribe,e.getSnapshot,e.getSnapshot);e.S();return e}Object.defineProperties(n.prototype,{$$typeof:{configurable:!0,value:h},type:{configurable:!0,value:function(n){var r=n.data,t=P(1);try{return r.value}finally{t.f()}}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});function useSignal(n){return o(function(){return t(n)},g)}function useComputed(n){var r=f(n);r.current=n;return o(function(){return e(function(){return r.current()})},g)}function useSignalEffect(n){var t=f(n);t.current=n;c(function(){return r(function(){return t.current()})},g)}!function(){Object.defineProperty(u.ReactCurrentDispatcher,"current",{get:function(){return p},set:function(n){if(!m){var r=b(p),t=b(n);p=n;if(function(n,r){if(1&n&&28&r)return!0;else if(2&n||2&r)return!1;else return!1}(r,t)){m=!0;v=P(1);m=!1}else if(function(n,r){return Boolean(28&n&&16&r)}(r,t)){var e;null==(e=v)||e.f();m=!0;v=P(1);m=!1}else if(function(n,r){return Boolean(28&n&&1&r)}(r,t)){var i;null==(i=v)||i.f();v=null}}else p=n}});!function(){var n=a,r=s;i.createElement=S(i.createElement);r.jsx&&(r.jsx=S(r.jsx));n.jsx&&(n.jsx=S(n.jsx));r.jsxs&&(r.jsxs=S(r.jsxs));n.jsxs&&(n.jsxs=S(n.jsxs));r.jsxDEV&&(r.jsxDEV=S(r.jsxDEV));n.jsxDEV&&(n.jsxDEV=S(n.jsxDEV))}()}();export{useComputed,useSignal,useSignalEffect};//# sourceMappingURL=signals.module.js.map
